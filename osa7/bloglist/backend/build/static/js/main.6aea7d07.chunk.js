(this.webpackJsonpblogilista=this.webpackJsonpblogilista||[]).push([[0],{24:function(e,t,n){e.exports=n(54)},53:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var a,r=n(0),l=n.n(r),c=n(8),u=n.n(c),o=n(7),i=n(5),s=n(22),d=n(23),m=n(1),f=n.n(m),p=n(4),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFICATION":return t.notification;default:return e}},h=Object(i.combineReducers)({notification:g}),b=Object(i.createStore)(h,Object(d.composeWithDevTools)(Object(i.applyMiddleware)(s.a))),E=n(3),v=function(e){return l.a.createElement("h1",null,e.text)},O=function(e){return l.a.createElement("input",{type:e.type,placeholder:e.placeholder,onChange:e.handleOnChange,id:e.id,value:e.value,name:e.name})},w=function(e){return l.a.createElement("h2",null,e.text)},k=function(e){return l.a.createElement("div",null,l.a.createElement(w,{text:"Search"}),"Filter by Name: ",l.a.createElement(O,{placeholder:"Name..",handleOnChange:e.handleFilterOnChange}))},C=function(e){return l.a.createElement("button",{onClick:e.handleClick,type:e.type,id:e.id},e.text)},j=function(e){var t=e.createBlog,n=e.showMessage,a=Object(r.useState)(""),c=Object(E.a)(a,2),u=c[0],o=c[1],i=Object(r.useState)(""),s=Object(E.a)(i,2),d=s[0],m=s[1],f=Object(r.useState)(""),p=Object(E.a)(f,2),g=p[0],h=p[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement(w,{text:"Add New Blog"}),l.a.createElement("form",null,l.a.createElement("div",null,"Title: ",l.a.createElement(O,{placeholder:"Title..",handleOnChange:function(e){o(e.target.value)},id:"titleInput0"}),l.a.createElement("br",null),"Author: ",l.a.createElement(O,{placeholder:"Author..",handleOnChange:function(e){m(e.target.value)},id:"authorInput0"}),l.a.createElement("br",null),"Url: ",l.a.createElement(O,{placeholder:"Url..",handleOnChange:function(e){h(e.target.value)},id:"urlInput0"})),l.a.createElement("div",null,l.a.createElement(C,{type:"submit",handleClick:function(e){e.preventDefault(),""===u?n("Input title","error"):""===d?n("Input author","error"):""===g?n("Input url","error"):(t({title:u,author:d,url:g}),o(""),m(""),h(""))},text:"Add",id:"addNewBlogButton"}))))},y=l.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(E.a)(n,2),c=a[0],u=a[1],o={display:c?"none":""},i={display:c?"":"none"},s=function(){u(!c)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),l.a.createElement("div",null,l.a.createElement("div",{style:o},l.a.createElement(C,{handleClick:s,text:e.buttonLabel,id:e.idView})),l.a.createElement("div",{style:i,className:"togglableContent"},e.children,l.a.createElement(C,{handleClick:s,text:e.buttonHideLabel,id:e.idHide})))})),x=function(e){var t=e.blog,n=e.user,a=e.handleLikeClick,r=e.handleDeleteClick;return l.a.createElement("tr",{id:t.id,key:t.id,className:"blog"},l.a.createElement("td",null,t.title),l.a.createElement("td",null,t.author),l.a.createElement("td",null,l.a.createElement(y,{buttonLabel:"View",buttonHideLabel:"Hide Info",idView:t.title.trim()},l.a.createElement("div",null,l.a.createElement("p",null,"URL: ",t.url),l.a.createElement("p",null,"Likes: ",t.likes," ",l.a.createElement(C,{text:"like",handleClick:function(){return a(t)}})),t.user?l.a.createElement("p",null,"Added by: ",t.user.name):"",t.user&&n.username===t.user.username?l.a.createElement(C,{text:"Delete Blog",id:(t.title+t.author).trim(),handleClick:function(){return r(t.id,t.title)}}):""))))},I=function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement(w,{text:"Blogs"}),l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Title"),l.a.createElement("th",null,"Author"),l.a.createElement("th",null,"Info"))),l.a.createElement("tbody",null,e.blogs.map((function(t,n){return l.a.createElement(l.a.Fragment,null,l.a.createElement(x,{blog:t,user:e.user,handleLikeClick:e.handleLikeClick,handleDeleteClick:e.handleDeleteClick,rowIndex:"row".concat(n)}))})))))},B=n(6),L=n.n(B),S=null,N={getAll:function(){return L.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(p.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:S}},e.next=3,L.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return L.a.put("".concat("/api/blogs","/").concat(t),e).then((function(e){return e.data}))},deleteBlog:function(e){var t={headers:{Authorization:S}};return L.a.delete("".concat("/api/blogs","/").concat(e),t).then((function(e){return e}))},setToken:function(e){S="bearer ".concat(e)}},T=function(){var e=Object(o.c)((function(e){return e.notification}));return l.a.createElement("div",{className:e.msgClass},e.msg)},A=function(e){return l.a.createElement("form",{onSubmit:e.handleLogin},l.a.createElement("div",null,"username",l.a.createElement(O,{type:"text",value:e.username,name:"Username",handleOnChange:function(t){var n=t.target;return e.setUsername(n.value)},id:"inputUsername"})),l.a.createElement("div",null,"password",l.a.createElement(O,{type:"password",value:e.password,name:"Password",handleOnChange:function(t){var n=t.target;return e.setPassword(n.value)},id:"inputPassword"})),l.a.createElement(C,{type:"submit",text:"Login",id:"loginButton"}))},D={login:function(){var e=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},F=(n(53),function(){var e=Object(r.useState)([]),t=Object(E.a)(e,2),n=t[0],c=t[1],u=Object(r.useState)(""),i=Object(E.a)(u,2),s=(i[0],i[1]),d=Object(r.useState)(n.sort((function(e,t){return e.likes<t.likes?1:-1}))),m=Object(E.a)(d,2),g=m[0],h=m[1],b=Object(r.useState)(""),O=Object(E.a)(b,2),w=O[0],x=O[1],B=Object(r.useState)(""),L=Object(E.a)(B,2),S=L[0],F=L[1],U=Object(r.useState)(null),H=Object(E.a)(U,2),V=H[0],J=H[1];Object(r.useEffect)((function(){N.getAll().then((function(e){c(e),console.log(e),h(e)})).catch((function(e){Y("Error caught: ".concat(e),"error")}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);J(t),N.setToken(t.token),console.log(t)}}),[]);var M=Object(o.b)(),P=function(){var e=Object(p.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,D.login({username:w,password:S});case 4:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),N.setToken(n.token),J(n),x(""),F(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Y("wrong credentials","error");case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(p.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,q.current.toggleVisibility(),e.next=4,N.create(t);case 4:a=e.sent,c(n.concat(a.savedBlog)),h(n.concat(a.savedBlog)),Y("Added ".concat(a.savedBlog.title),"success"),W(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),Y(e.t0,"error");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(p.a)(f.a.mark((function e(t,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="Do you really want to delete ".concat(a,"?"),!window.confirm(r)){e.next=14;break}return e.prev=2,e.next=5,N.deleteBlog(t);case 5:e.sent,c(n.filter((function(e){return e.id!==t}))),h(n.filter((function(e){return e.id!==t}))),Y('The "'.concat(a,'" blog has beed deleted'),"neutral"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),Y(e.t0,"error");case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){s(""),document.getElementById("titleInput0").value="",document.getElementById("authorInput0").value="",document.getElementById("urlInput0").value=""},Y=function(e,t){var n,r;M((n={msg:e,msgClass:t},r=5,function(){var e=Object(p.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({type:"NOTIFICATION",notification:n});case 2:clearTimeout(a),a=setTimeout((function(){t({type:"NOTIFICATION",notification:{msg:"",msgClass:void 0},timeout:!0})}),1e3*r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},q=l.a.createRef();return null===V?l.a.createElement("div",null,l.a.createElement(v,{text:"Bloglist"}),l.a.createElement(T,null),l.a.createElement(y,{buttonLabel:"Login",buttonHideLabel:"Cancel"},l.a.createElement(A,{handleLogin:P,username:w,setUsername:x,password:S,setPassword:F}))):l.a.createElement("div",null,l.a.createElement(v,{text:"Bloglist"}),l.a.createElement(T,null),l.a.createElement("p",null,V.name," logged in"),l.a.createElement(C,{text:"logout",handleClick:function(){console.log("logging out"),J(null),window.localStorage.clear()}}),l.a.createElement(y,{buttonLabel:"New Blog",ref:q,buttonHideLabel:"Cancel"},l.a.createElement(j,{createBlog:R,showMessage:Y})),l.a.createElement(k,{handleFilterOnChange:function(e){var t=n.filter((function(t){return t.title.toLowerCase().includes(e.target.value.toLowerCase())}));h(t)}}),l.a.createElement(I,{blogs:g,handleDeleteClick:z,handleLikeClick:function(e){console.log(e);var t={title:e.title,author:e.author,url:e.url,likes:e.likes+=1,user:e.user?e.user.id:void 0};N.update(t,e.id).then((function(){c(n),Y("You liked ".concat(t.title),"success")})).catch((function(e){Y(e,"error")}))},user:V}))});u.a.render(l.a.createElement(o.a,{store:b},l.a.createElement(l.a.StrictMode,null,l.a.createElement(F,null))),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.6aea7d07.chunk.js.map